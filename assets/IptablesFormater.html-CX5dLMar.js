import{_ as t,c as i,a as s,d as n,e as p,f as r,r as c,o as m,b as l}from"./app-BCC5ysrj.js";const o={},b={class:"vuepress-toc"},d={class:"vuepress-toc-item"},v={class:"vuepress-toc-item"},u={class:"vuepress-toc-item"},k={class:"vuepress-toc-item"},h={class:"vuepress-toc-item"},T={class:"vuepress-toc-item"},P={class:"vuepress-toc-item"};function g(A,a){const e=c("router-link");return m(),i("div",null,[a[7]||(a[7]=s("h1",{id:"iptables-用法",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#iptables-用法"},[s("span",null,"iptables 用法")])],-1)),s("nav",b,[s("ul",null,[s("li",d,[n(e,{to:"#命令格式"},{default:p(()=>a[0]||(a[0]=[l("命令格式")])),_:1})]),s("li",v,[n(e,{to:"#iptables命令的管理控制选项"},{default:p(()=>a[1]||(a[1]=[l("iptables命令的管理控制选项")])),_:1})]),s("li",u,[n(e,{to:"#防火墙处理数据包的四种方式"},{default:p(()=>a[2]||(a[2]=[l("防火墙处理数据包的四种方式")])),_:1}),s("ul",null,[s("li",k,[n(e,{to:"#iptables防火墙规则的保存与恢复"},{default:p(()=>a[3]||(a[3]=[l("iptables防火墙规则的保存与恢复")])),_:1})])])]),s("li",h,[n(e,{to:"#删除input链的第一条规则"},{default:p(()=>a[4]||(a[4]=[l("删除INPUT链的第一条规则")])),_:1})]),s("li",T,[n(e,{to:"#iptables防火墙常用的策略"},{default:p(()=>a[5]||(a[5]=[l("iptables防火墙常用的策略")])),_:1}),s("ul",null,[s("li",P,[n(e,{to:"#常用的linux-iptables规则"},{default:p(()=>a[6]||(a[6]=[l("常用的linux iptables规则")])),_:1})])])])])]),a[8]||(a[8]=r(`<hr><h2 id="命令格式" tabindex="-1"><a class="header-anchor" href="#命令格式"><span>命令格式</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">iptables <span class="token punctuation">[</span>-t 表名<span class="token punctuation">]</span> 命令选项 <span class="token punctuation">[</span>链名<span class="token punctuation">]</span> <span class="token punctuation">[</span>条件匹配<span class="token punctuation">]</span> <span class="token punctuation">[</span>-j 目标动作或跳转<span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>说明：</p><ul><li><strong>表名</strong> 链名用于指定iptables命令所操作的表和链</li><li><strong>命令选项</strong> 用于指定管理iptables规则的方式(插入，增加，删除，查看等等)</li><li><strong>条件匹配</strong> 用于指定对符合什么样条件的数据包进行处理</li><li><strong>目标动作或跳转</strong> 用于指定数据包的处理方式(比如允许通过，拒绝，丢弃，跳转(Jump)给其他链处理)</li></ul><h2 id="iptables命令的管理控制选项" tabindex="-1"><a class="header-anchor" href="#iptables命令的管理控制选项"><span>iptables命令的管理控制选项</span></a></h2><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">-A 在指定链的末尾添加(append)一条新的规则</span>
<span class="line">-D 删除(delete)指定链中的某一条规则，可以按规则顺序和内容删除</span>
<span class="line">-I 在指定链中插入(insert)一条新的规则，默认在第一行添加</span>
<span class="line">-R 修改/替换(replace)指定链中的某一条规则，可以按规则序号和内容替换</span>
<span class="line">-L 列出(list)指定链中所有的规则进行查看</span>
<span class="line">-E 重新用户定义的链，不改变链本身</span>
<span class="line">-F 清空(flush)</span>
<span class="line">-N 新建(new-chain)一条用户自己定义的规则链</span>
<span class="line">-X 删除指定表中用户自定义的规则连(delete-chain)</span>
<span class="line">-P 设置制定链的默认策略(policy)\\</span>
<span class="line">-Z 将所有表的所有链的字节和数据包计数器清零</span>
<span class="line">-n 使用数字形式(numeric)显示输出结果</span>
<span class="line">-v 查看规则表详细信息(verbose)的信息</span>
<span class="line">-V 查看版本(version)</span>
<span class="line">-h 获取帮助(help)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="防火墙处理数据包的四种方式" tabindex="-1"><a class="header-anchor" href="#防火墙处理数据包的四种方式"><span>防火墙处理数据包的四种方式</span></a></h2><table><thead><tr><th>名称</th><th>方法，达到的目的</th></tr></thead><tbody><tr><td>ACCEPT</td><td>允许数据包通过</td></tr><tr><td>DROP</td><td>直接丢弃数据包，不给任何回应信息</td></tr><tr><td>REJECT</td><td>拒绝数据包通过，必要时会给数据发送端一个相应的信息</td></tr><tr><td>LOG</td><td>在/var/log/messages文件中记录日志信息，然后将书记包传递给下一条规则</td></tr></tbody></table><h3 id="iptables防火墙规则的保存与恢复" tabindex="-1"><a class="header-anchor" href="#iptables防火墙规则的保存与恢复"><span>iptables防火墙规则的保存与恢复</span></a></h3><p>iptables-save把规则保存到文件中，再由目录rc.d下的脚本(/etc/rc.d/init/iptables)自动装载<br> 使用命令<code>iptables-save</code>来保存规则，一般用</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">iptables-save <span class="token operator">&gt;</span> /etc/sysconfig/iptables</span>
<span class="line"><span class="token comment"># 生成保存规则的文件\`\`/etc/sysconfig/iptables\`\`</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>也可以用</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">service</span> iptables save</span>
<span class="line"><span class="token comment"># 它能把规则自动保存在/etc/sysconfig/iptables中</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>当计算机启动时，<code>rc.d</code>下的脚本将用命令<code>iptables-restore</code>调用这个文件，从而就自动恢复了规则。</p><h2 id="删除input链的第一条规则" tabindex="-1"><a class="header-anchor" href="#删除input链的第一条规则"><span>删除INPUT链的第一条规则</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">iptables <span class="token parameter variable">-D</span> INPUT <span class="token number">1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="iptables防火墙常用的策略" tabindex="-1"><a class="header-anchor" href="#iptables防火墙常用的策略"><span>iptables防火墙常用的策略</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 1.拒绝-进入防火墙的所有ICMP协议的数据包</span></span>
<span class="line">iptables <span class="token parameter variable">-I</span> INPUT <span class="token parameter variable">-p</span> icmp <span class="token parameter variable">-j</span> REJECT</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 2.允许防火墙转发出ICMP协议以外的所有数据包</span></span>
<span class="line">iptables <span class="token parameter variable">-A</span> FORWARD <span class="token parameter variable">-p</span> <span class="token operator">!</span> icmp <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line"><span class="token comment">#！参数：“将条件去反”</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3.拒绝转发来自192.168.1.10主机的数据，允许转发来自192.168.0.0/24网段的数据</span></span>
<span class="line">iptables <span class="token parameter variable">-A</span> FORWARD <span class="token parameter variable">-s</span> <span class="token number">192.168</span>.1.10 <span class="token parameter variable">-j</span> REJECT</span>
<span class="line">iptables <span class="token parameter variable">-A</span> FORWARD <span class="token parameter variable">-s</span> <span class="token number">192.168</span>.0.0/24 <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line"><span class="token comment">#说明:要把拒绝的放在前面不然就不起作用了</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 4.丢弃从外网接口(eth1)进入防火墙本机的原地址为私网地址的数据包</span></span>
<span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-i</span> eth1 <span class="token parameter variable">-s</span> <span class="token number">192.168</span>.0.0/16 <span class="token parameter variable">-j</span> DROP</span>
<span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-i</span> eth1 <span class="token parameter variable">-s</span> <span class="token number">172.16</span>.0.0/12 <span class="token parameter variable">-j</span> DROP</span>
<span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-i</span> eth1 <span class="token parameter variable">-s</span> <span class="token number">10.0</span>.0.0/8 <span class="token parameter variable">-j</span> DROP</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 5.封堵网段(192.168.1.0/24),两小时后解封</span></span>
<span class="line">iptables <span class="token parameter variable">-I</span> INPUT <span class="token parameter variable">-s</span> <span class="token number">192.168</span>.1.0/24 <span class="token parameter variable">-j</span> DROP</span>
<span class="line">iptables <span class="token parameter variable">-I</span> FORWARD <span class="token parameter variable">-s</span> <span class="token number">192.168</span>.1.0/24 <span class="token parameter variable">-j</span> DROP</span>
<span class="line">at now <span class="token number">2</span> hours at <span class="token operator">&gt;</span> iptables <span class="token parameter variable">-D</span> INPUT <span class="token number">1</span> at <span class="token operator">&gt;</span> iptables <span class="token parameter variable">-D</span> FORWARD <span class="token number">1</span></span>
<span class="line"><span class="token comment">#说明：这个策略借助cron计划来完成</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 6.只允许管理员从202.13.0.0/16网段使用SSH远程登录防火墙主机  </span></span>
<span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">22</span> <span class="token parameter variable">-s</span> <span class="token number">202.13</span>.0.0/16 <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">22</span> <span class="token parameter variable">-j</span> DROP</span>
<span class="line"><span class="token comment">#说明：这个用法比较适合对设备进行远程管理时使用，比如位于分公司的SQL服务器需要被总公司的管理员管理时。</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 7.允许本机开放从TCP端口20--1024提供那个的应用服务</span></span>
<span class="line">iptabels <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">20</span>:1024 <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line">iptables <span class="token parameter variable">-A</span> OUTPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--sport</span> <span class="token number">20</span>:1024 <span class="token parameter variable">-j</span> ACCPET</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 8.允许转发来自192.168.0.0/24局域网段的DNS解析请求数据包</span></span>
<span class="line">iptables <span class="token parameter variable">-A</span> FORWARD <span class="token parameter variable">-s</span> <span class="token number">192.168</span>.0.0/24 <span class="token parameter variable">-p</span> udp <span class="token parameter variable">--dport</span> <span class="token number">53</span> <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line">iptables <span class="token parameter variable">-A</span> FORWARD <span class="token parameter variable">-d</span> <span class="token number">192.168</span>.0.0/24 <span class="token parameter variable">-p</span> udp <span class="token parameter variable">--sport</span> <span class="token number">53</span> <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 9 禁止其他主机ping防火墙主机，但是允许从防火墙上ping其他主机</span></span>
<span class="line">iptables <span class="token parameter variable">-I</span> INPUT <span class="token parameter variable">-p</span> icmp --icmp-type Echo-Request <span class="token parameter variable">-j</span> DROP</span>
<span class="line">iptables <span class="token parameter variable">-I</span> INPUT <span class="token parameter variable">-p</span> icmp --icmp-type Echo-Reply <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line">iptables <span class="token parameter variable">-I</span> INPUT <span class="token parameter variable">-p</span> icmp --icmp-type destination-Unreachable <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 10.禁止转发来自MAC地址为00:0C:29:27:55:3F的和主机的数据包</span></span>
<span class="line">iptables <span class="token parameter variable">-A</span> FORWARD <span class="token parameter variable">-m</span> mac --mac-source 00:0C:29:27:55:3F <span class="token parameter variable">-j</span> DROP</span>
<span class="line"><span class="token comment">#说明:iptables中使用“-m”模块关键字形式调用显示匹配。这里用“-m mac --mac-source”来表示数据包的源MAC地址</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 11.允许防火墙本机开放TCP端口20、21、25、110以及被动模式FTP端口1250-1280</span></span>
<span class="line">iptables <span class="token parameter variable">-A</span> INOUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> multiport <span class="token parameter variable">--dport</span> <span class="token number">20,21</span>,25,110,1250:1280 <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line"><span class="token comment">#说明：这里用&quot;这里用 -m multiport --dport&quot; 来指定目的端口及范围</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 12.禁止转发源IP地址为192.168.1.20-192.168.1.99的TCP数据包</span></span>
<span class="line">iptables <span class="token parameter variable">-A</span> FORWARD <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> iprange --src-range <span class="token number">192.168</span>.1.20-192.168.1.99 <span class="token parameter variable">-j</span> DROP</span>
<span class="line"><span class="token comment">#说明： 此处用“-m iprange --src-range”指定IP范围</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 13.禁止转发与正常TCP连接无关的非-syn请求数据包</span></span>
<span class="line">iptables <span class="token parameter variable">-A</span> FORWARD <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> NEW <span class="token parameter variable">-p</span> tcp <span class="token operator">!</span> <span class="token parameter variable">--syn</span> <span class="token parameter variable">-j</span> DROP</span>
<span class="line"><span class="token comment"># 说明：“-m state”表示数据包的连接状态，“NEW”表示与任何连接无关的，新的嘛！</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 14.拒绝访问防火墙的新数据包，但允许响应连接或与已有连接相关的数据包</span></span>
<span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> NEW <span class="token parameter variable">-j</span> DROP</span>
<span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> ESTABLISHED,RELATED <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line"><span class="token comment"># 说明：“ESTABLISHED”表示已经响应请求或者已经建立连接的数据包，“RELATED”表示与已建立的连接有相关性的，比如FTP数据连接等。</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 15.只开放本机的web服务(80) / FTP(20,21,20450-20480),放行外部主机发送服务器其他端口的应答数据包，将其他入站数据包均予以丢弃处理</span></span>
<span class="line">iptables <span class="token parameter variable">-I</span> INPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> multiport <span class="token parameter variable">--dport</span> <span class="token number">20,21</span>,80 <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line">iptables <span class="token parameter variable">-I</span> INPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-dport</span> <span class="token number">20450</span>:20480 <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line">iptables <span class="token parameter variable">-I</span> INPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> ESTABLISHED <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line">iptables <span class="token parameter variable">-P</span> INPUT DROP</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="常用的linux-iptables规则" tabindex="-1"><a class="header-anchor" href="#常用的linux-iptables规则"><span>常用的linux iptables规则</span></a></h3><h4 id="_1-删除所有现有规则" tabindex="-1"><a class="header-anchor" href="#_1-删除所有现有规则"><span>1.删除所有现有规则</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">iptables <span class="token parameter variable">-F</span> </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_2-设置默认的chain策略" tabindex="-1"><a class="header-anchor" href="#_2-设置默认的chain策略"><span>2.设置默认的chain策略</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">iptables <span class="token parameter variable">-P</span> INPUT DROP</span>
<span class="line">iptables <span class="token parameter variable">-P</span> FORWARD DROP</span>
<span class="line">iptables <span class="token parameter variable">-P</span> OUTPUT DROP</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-阻止某个特定的ip地址" tabindex="-1"><a class="header-anchor" href="#_3-阻止某个特定的ip地址"><span>3.阻止某个特定的IP地址</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token assign-left variable">BLOCK_THIS_IP</span><span class="token operator">=</span><span class="token string">&quot;x.x.x.x&quot;</span></span>
<span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-s</span> <span class="token string">&quot;<span class="token variable">$BLOCK_THIS_IP</span>&quot;</span> <span class="token parameter variable">-j</span> DROP</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-允许全部进来的ssh" tabindex="-1"><a class="header-anchor" href="#_4-允许全部进来的ssh"><span>4.允许全部进来的SSH</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-i</span> eth0 <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">22</span> <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> NEW,ESTABLISHED <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line">iptables <span class="token parameter variable">-A</span> OUTPUT <span class="token parameter variable">-o</span> eth0 <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">22</span> <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> ESTABLISHED <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-只允许某个特定网路进来的ssh" tabindex="-1"><a class="header-anchor" href="#_5-只允许某个特定网路进来的ssh"><span>5.只允许某个特定网路进来的SSH</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-i</span> eth0 <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-s</span> <span class="token number">192.168</span>.200.0/24 <span class="token parameter variable">--dport</span> <span class="token number">22</span> <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> NEW,ESTABLISHED <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line"></span>
<span class="line">iptables <span class="token parameter variable">-A</span> OUTPUT <span class="token parameter variable">-o</span> eth0 <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> 22m <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> ESTABLISHED <span class="token parameter variable">-j</span> APPECT</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-允许进来的http" tabindex="-1"><a class="header-anchor" href="#_6-允许进来的http"><span>6.允许进来的HTTP</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-i</span> eth0 <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">80</span> <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> NEW,ESTABLISHED <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line">iptables <span class="token parameter variable">-A</span> OUTPUT <span class="token parameter variable">-o</span> eth0 <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">80</span> <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> ESTABLISHED <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7-多端口-允许进来的ssh、http和https" tabindex="-1"><a class="header-anchor" href="#_7-多端口-允许进来的ssh、http和https"><span>7.多端口（允许进来的SSH、HTTP和HTTPS）</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-i</span> eth0 <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> multiport <span class="token parameter variable">--dports</span> <span class="token number">22,80</span>,443 <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> NEW.ESTABLISHED <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line">iptables <span class="token parameter variable">-A</span> OUTPUR <span class="token parameter variable">-o</span> eth0 <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> multiport <span class="token parameter variable">--dports</span> <span class="token number">22,80</span>,443 <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> ESTABLISHED <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8-允许出去的ssh" tabindex="-1"><a class="header-anchor" href="#_8-允许出去的ssh"><span>8.允许出去的SSH</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">iptables <span class="token parameter variable">-A</span> OUTPUT <span class="token parameter variable">-o</span> eth0 <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">22</span> <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> NEW,ESTABLISHED <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-i</span> eth0 <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--sport</span> <span class="token number">22</span> <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> ESTABLISHED <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div>`,36))])}const I=t(o,[["render",g],["__file","IptablesFormater.html.vue"]]),C=JSON.parse('{"path":"/flinux/Iptable/IptablesFormater.html","title":"iptables 用法","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"命令格式","slug":"命令格式","link":"#命令格式","children":[]},{"level":2,"title":"iptables命令的管理控制选项","slug":"iptables命令的管理控制选项","link":"#iptables命令的管理控制选项","children":[]},{"level":2,"title":"防火墙处理数据包的四种方式","slug":"防火墙处理数据包的四种方式","link":"#防火墙处理数据包的四种方式","children":[{"level":3,"title":"iptables防火墙规则的保存与恢复","slug":"iptables防火墙规则的保存与恢复","link":"#iptables防火墙规则的保存与恢复","children":[]}]},{"level":2,"title":"删除INPUT链的第一条规则","slug":"删除input链的第一条规则","link":"#删除input链的第一条规则","children":[]},{"level":2,"title":"iptables防火墙常用的策略","slug":"iptables防火墙常用的策略","link":"#iptables防火墙常用的策略","children":[{"level":3,"title":"常用的linux iptables规则","slug":"常用的linux-iptables规则","link":"#常用的linux-iptables规则","children":[]}]}],"git":{"updatedTime":1701020615000,"contributors":[{"name":"Linkefou","username":"Linkefou","email":"wlh724567296@163.com","commits":1}]},"filePathRelative":"flinux/Iptable/IptablesFormater.md"}');export{I as comp,C as data};
