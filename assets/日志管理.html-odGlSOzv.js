import{_ as t,c as o,a as n,d as e,e as l,f as p,r,o as c,b as i}from"./app-BCC5ysrj.js";const d={},u={class:"vuepress-toc"},v={class:"vuepress-toc-item"},m={class:"vuepress-toc-item"},h={class:"vuepress-toc-item"},g={class:"vuepress-toc-item"},b={class:"vuepress-toc-item"},_={class:"vuepress-toc-item"},k={class:"vuepress-toc-item"},f={class:"vuepress-toc-item"},x={class:"vuepress-toc-item"},y={class:"vuepress-toc-item"},w={class:"vuepress-toc-item"},q={class:"vuepress-toc-item"},j={class:"vuepress-toc-item"},E={class:"vuepress-toc-item"},z={class:"vuepress-toc-item"};function N($,s){const a=r("router-link");return c(),o("div",null,[s[15]||(s[15]=n("h1",{id:"linux-系统日志管理",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#linux-系统日志管理"},[n("span",null,"Linux 系统日志管理")])],-1)),n("nav",u,[n("ul",null,[n("li",v,[e(a,{to:"#_1-系统日志概述"},{default:l(()=>s[0]||(s[0]=[i("1. 系统日志概述")])),_:1}),n("ul",null,[n("li",m,[e(a,{to:"#_1-1-日志类型"},{default:l(()=>s[1]||(s[1]=[i("1.1 日志类型")])),_:1})])])]),n("li",h,[e(a,{to:"#_2-日志管理工具"},{default:l(()=>s[2]||(s[2]=[i("2. 日志管理工具")])),_:1}),n("ul",null,[n("li",g,[e(a,{to:"#_2-1-基本命令"},{default:l(()=>s[3]||(s[3]=[i("2.1 基本命令")])),_:1})]),n("li",b,[e(a,{to:"#_2-2-日志分析工具"},{default:l(()=>s[4]||(s[4]=[i("2.2 日志分析工具")])),_:1})])])]),n("li",_,[e(a,{to:"#_3-日志配置"},{default:l(()=>s[5]||(s[5]=[i("3. 日志配置")])),_:1}),n("ul",null,[n("li",k,[e(a,{to:"#_3-1-rsyslog-配置"},{default:l(()=>s[6]||(s[6]=[i("3.1 rsyslog 配置")])),_:1})]),n("li",f,[e(a,{to:"#_3-2-logrotate-配置"},{default:l(()=>s[7]||(s[7]=[i("3.2 logrotate 配置")])),_:1})])])]),n("li",x,[e(a,{to:"#_4-日志分析方法"},{default:l(()=>s[8]||(s[8]=[i("4. 日志分析方法")])),_:1}),n("ul",null,[n("li",y,[e(a,{to:"#_4-1-���用分析命令"},{default:l(()=>s[9]||(s[9]=[i("4.1 ���用分析命令")])),_:1})]),n("li",w,[e(a,{to:"#_4-2-日志监控脚本"},{default:l(()=>s[10]||(s[10]=[i("4.2 日志监控脚本")])),_:1})])])]),n("li",q,[e(a,{to:"#_5-日志安全"},{default:l(()=>s[11]||(s[11]=[i("5. 日志安全")])),_:1}),n("ul",null,[n("li",j,[e(a,{to:"#_5-1-日志加密"},{default:l(()=>s[12]||(s[12]=[i("5.1 日志加密")])),_:1})]),n("li",E,[e(a,{to:"#_5-2-远程日志"},{default:l(()=>s[13]||(s[13]=[i("5.2 远程日志")])),_:1})])])]),n("li",z,[e(a,{to:"#_6-最佳实践"},{default:l(()=>s[14]||(s[14]=[i("6. 最佳实践")])),_:1})])])]),s[16]||(s[16]=p(`<h2 id="_1-系统日志概述" tabindex="-1"><a class="header-anchor" href="#_1-系统日志概述"><span>1. 系统日志概述</span></a></h2><h3 id="_1-1-日志类型" tabindex="-1"><a class="header-anchor" href="#_1-1-日志类型"><span>1.1 日志类型</span></a></h3><ol><li><p><strong>系统日志</strong></p><ul><li><code>/var/log/syslog</code></li><li><code>/var/log/messages</code></li><li><code>/var/log/dmesg</code></li></ul></li><li><p><strong>应用日志</strong></p><ul><li><code>/var/log/apache2/</code></li><li><code>/var/log/nginx/</code></li><li><code>/var/log/mysql/</code></li></ul></li><li><p><strong>安全日志</strong></p><ul><li><code>/var/log/auth.log</code></li><li><code>/var/log/secure</code></li><li><code>/var/log/audit/</code></li></ul></li></ol><h2 id="_2-日志管理工具" tabindex="-1"><a class="header-anchor" href="#_2-日志管理工具"><span>2. 日志管理工具</span></a></h2><h3 id="_2-1-基本命令" tabindex="-1"><a class="header-anchor" href="#_2-1-基本命令"><span>2.1 基本命令</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 查看实时日志</span></span>
<span class="line"><span class="token function">tail</span> <span class="token parameter variable">-f</span> /var/log/syslog</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 搜索日志内容</span></span>
<span class="line"><span class="token function">grep</span> <span class="token string">&quot;error&quot;</span> /var/log/syslog</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 统计日志数量</span></span>
<span class="line"><span class="token function">wc</span> <span class="token parameter variable">-l</span> /var/log/syslog</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-日志分析工具" tabindex="-1"><a class="header-anchor" href="#_2-2-日志分析工具"><span>2.2 日志分析工具</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 安装 logwatch</span></span>
<span class="line"><span class="token function">apt</span> <span class="token function">install</span> logwatch  <span class="token comment"># Ubuntu/Debian</span></span>
<span class="line">yum <span class="token function">install</span> logwatch  <span class="token comment"># CentOS/RHEL</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 使用 logwatch</span></span>
<span class="line">logwatch <span class="token parameter variable">--detail</span> High <span class="token parameter variable">--range</span> All <span class="token parameter variable">--output</span> stdout</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-日志配置" tabindex="-1"><a class="header-anchor" href="#_3-日志配置"><span>3. 日志配置</span></a></h2><h3 id="_3-1-rsyslog-配置" tabindex="-1"><a class="header-anchor" href="#_3-1-rsyslog-配置"><span>3.1 rsyslog 配置</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 编辑 rsyslog 配置</span></span>
<span class="line"><span class="token function">vim</span> /etc/rsyslog.conf</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 重启 rsyslog 服务</span></span>
<span class="line">systemctl restart rsyslog</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2-logrotate-配置" tabindex="-1"><a class="header-anchor" href="#_3-2-logrotate-配置"><span>3.2 logrotate 配置</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 编辑 logrotate 配置</span></span>
<span class="line"><span class="token function">vim</span> /etc/logrotate.conf</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 创建自定义规则</span></span>
<span class="line"><span class="token function">vim</span> /etc/logrotate.d/custom</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-日志分析方法" tabindex="-1"><a class="header-anchor" href="#_4-日志分析方法"><span>4. 日志分析方法</span></a></h2><h3 id="_4-1-���用分析命令" tabindex="-1"><a class="header-anchor" href="#_4-1-���用分析命令"><span>4.1 ���用分析命令</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 提取错误信息</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;/error/&#39;</span> /var/log/syslog</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 统计访问 IP</span></span>
<span class="line"><span class="token function">awk</span> <span class="token string">&#39;{print $1}&#39;</span> access.log <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">uniq</span> <span class="token parameter variable">-c</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 分析时间段</span></span>
<span class="line"><span class="token function">sed</span> <span class="token parameter variable">-n</span> <span class="token string">&#39;/May 20 10:00:00/,/May 20 11:00:00/p&#39;</span> syslog</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-2-日志监控脚本" tabindex="-1"><a class="header-anchor" href="#_4-2-日志监控脚本"><span>4.2 日志监控脚本</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token shebang important">#!/bin/bash</span></span>
<span class="line"><span class="token comment"># 监控日志文件大小</span></span>
<span class="line"><span class="token assign-left variable">log_file</span><span class="token operator">=</span><span class="token string">&quot;/var/log/syslog&quot;</span></span>
<span class="line"><span class="token assign-left variable">max_size</span><span class="token operator">=</span><span class="token number">100000000</span>  <span class="token comment"># 100MB</span></span>
<span class="line"></span>
<span class="line"><span class="token assign-left variable">current_size</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">du</span> <span class="token parameter variable">-b</span> <span class="token string">&quot;<span class="token variable">$log_file</span>&quot;</span> <span class="token operator">|</span> <span class="token function">cut</span> <span class="token parameter variable">-f1</span><span class="token variable">)</span></span></span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$current_size</span> <span class="token parameter variable">-gt</span> <span class="token variable">$max_size</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></span>
<span class="line">    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Log file too large: <span class="token variable">$log_file</span>&quot;</span></span>
<span class="line">    logger <span class="token string">&quot;Warning: Log file size exceeded threshold&quot;</span></span>
<span class="line"><span class="token keyword">fi</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-日志安全" tabindex="-1"><a class="header-anchor" href="#_5-日志安全"><span>5. 日志安全</span></a></h2><h3 id="_5-1-日志加密" tabindex="-1"><a class="header-anchor" href="#_5-1-日志加密"><span>5.1 日志加密</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 使用 GPG 加密日志</span></span>
<span class="line">gpg <span class="token parameter variable">-c</span> logfile.log</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 日志文件权限设置</span></span>
<span class="line"><span class="token function">chmod</span> <span class="token number">640</span> /var/log/secure</span>
<span class="line"><span class="token function">chown</span> root:adm /var/log/secure</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-2-远程日志" tabindex="-1"><a class="header-anchor" href="#_5-2-远程日志"><span>5.2 远程日志</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 配置远程日志服务器</span></span>
<span class="line"><span class="token comment"># 在 /etc/rsyslog.conf 中添加</span></span>
<span class="line">*.* @remote-host:514</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 启用 TCP 传输</span></span>
<span class="line">*.* @@remote-host:514</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-最佳实践" tabindex="-1"><a class="header-anchor" href="#_6-最佳实践"><span>6. 最佳实践</span></a></h2><ol><li><p><strong>日志策略</strong></p><ul><li>确定日志级别</li><li>设置保留期限</li><li>规划存储空间</li></ul></li><li><p><strong>监控告警</strong></p><ul><li>设置关键字告警</li><li>监控日志大小</li><li>配置自动响应</li></ul></li><li><p><strong>安全考虑</strong></p><ul><li>日志访问控制</li><li>日志完整性检查</li><li>日志备份策略</li></ul></li></ol>`,25))])}const C=t(d,[["render",N],["__file","日志管理.html.vue"]]),L=JSON.parse('{"path":"/flinux/log/%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86.html","title":"Linux 系统日志管理","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"1. 系统日志概述","slug":"_1-系统日志概述","link":"#_1-系统日志概述","children":[{"level":3,"title":"1.1 日志类型","slug":"_1-1-日志类型","link":"#_1-1-日志类型","children":[]}]},{"level":2,"title":"2. 日志管理工具","slug":"_2-日志管理工具","link":"#_2-日志管理工具","children":[{"level":3,"title":"2.1 基本命令","slug":"_2-1-基本命令","link":"#_2-1-基本命令","children":[]},{"level":3,"title":"2.2 日志分析工具","slug":"_2-2-日志分析工具","link":"#_2-2-日志分析工具","children":[]}]},{"level":2,"title":"3. 日志配置","slug":"_3-日志配置","link":"#_3-日志配置","children":[{"level":3,"title":"3.1 rsyslog 配置","slug":"_3-1-rsyslog-配置","link":"#_3-1-rsyslog-配置","children":[]},{"level":3,"title":"3.2 logrotate 配置","slug":"_3-2-logrotate-配置","link":"#_3-2-logrotate-配置","children":[]}]},{"level":2,"title":"4. 日志分析方法","slug":"_4-日志分析方法","link":"#_4-日志分析方法","children":[{"level":3,"title":"4.1 ���用分析命令","slug":"_4-1-���用分析命令","link":"#_4-1-���用分析命令","children":[]},{"level":3,"title":"4.2 日志监控脚本","slug":"_4-2-日志监控脚本","link":"#_4-2-日志监控脚本","children":[]}]},{"level":2,"title":"5. 日志安全","slug":"_5-日志安全","link":"#_5-日志安全","children":[{"level":3,"title":"5.1 日志加密","slug":"_5-1-日志加密","link":"#_5-1-日志加密","children":[]},{"level":3,"title":"5.2 远程日志","slug":"_5-2-远程日志","link":"#_5-2-远程日志","children":[]}]},{"level":2,"title":"6. 最佳实践","slug":"_6-最佳实践","link":"#_6-最佳实践","children":[]}],"git":{"updatedTime":1735033700000,"contributors":[{"name":"wanglinhao","username":"wanglinhao","email":"wanglinhao@wegooooo.com","commits":1}]},"filePathRelative":"flinux/log/日志管理.md"}');export{C as comp,L as data};
