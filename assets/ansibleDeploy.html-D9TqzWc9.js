import{_ as t,c as p,a as n,d as e,e as l,f as c,r as o,o as d,b as i}from"./app-BCC5ysrj.js";const r={},u={class:"vuepress-toc"},v={class:"vuepress-toc-item"},b={class:"vuepress-toc-item"},k={class:"vuepress-toc-item"},m={class:"vuepress-toc-item"},h={class:"vuepress-toc-item"},y={class:"vuepress-toc-item"},_={class:"vuepress-toc-item"};function f(g,s){const a=o("router-link");return d(),p("div",null,[s[7]||(s[7]=n("h1",{id:"ansible-实战",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ansible-实战"},[n("span",null,"Ansible 实战")])],-1)),n("nav",u,[n("ul",null,[n("li",v,[e(a,{to:"#项目目标"},{default:l(()=>s[0]||(s[0]=[i("项目目标")])),_:1})]),n("li",b,[e(a,{to:"#环境规划"},{default:l(()=>s[1]||(s[1]=[i("环境规划")])),_:1}),n("ul",null,[n("li",k,[e(a,{to:"#服务器角色"},{default:l(()=>s[2]||(s[2]=[i("服务器角色")])),_:1})])])]),n("li",m,[e(a,{to:"#部署步骤"},{default:l(()=>s[3]||(s[3]=[i("部署步骤")])),_:1}),n("ul",null,[n("li",h,[e(a,{to:"#_1-准备工作"},{default:l(()=>s[4]||(s[4]=[i("1. 准备工作")])),_:1})]),n("li",y,[e(a,{to:"#_2-编写-playbook"},{default:l(()=>s[5]||(s[5]=[i("2. 编写 Playbook")])),_:1})])])]),n("li",_,[e(a,{to:"#最佳实践"},{default:l(()=>s[6]||(s[6]=[i("最佳实践")])),_:1})])])]),s[8]||(s[8]=c(`<hr><h2 id="项目目标" tabindex="-1"><a class="header-anchor" href="#项目目标"><span>项目目标</span></a></h2><p>部署一个完整的 Web 服务架构：</p><ol><li><p>负载均衡层</p><ul><li>Keepalived + Nginx 主备模式</li></ul></li><li><p>Web 应用层</p><ul><li>Apache + PHP + PHP-MySQL</li></ul></li><li><p>数据库层</p><ul><li>MariaDB Server</li></ul></li></ol><h2 id="环境规划" tabindex="-1"><a class="header-anchor" href="#环境规划"><span>环境规划</span></a></h2><h3 id="服务器角色" tabindex="-1"><a class="header-anchor" href="#服务器角色"><span>服务器角色</span></a></h3><table><thead><tr><th>主机</th><th>IP</th><th>角色</th></tr></thead><tbody><tr><td>A</td><td>192.168.50.66</td><td>Ansible 控制节点 + Keepalived Master</td></tr><tr><td>B</td><td>192.168.50.110</td><td>Keepalived Backup</td></tr><tr><td>C</td><td>192.168.50.111</td><td>Web 节点 1</td></tr><tr><td>D</td><td>192.168.50.112</td><td>Web 节点 2</td></tr><tr><td>E</td><td>192.168.50.113</td><td>Database 节点</td></tr></tbody></table><h2 id="部署步骤" tabindex="-1"><a class="header-anchor" href="#部署步骤"><span>部署步骤</span></a></h2><h3 id="_1-准备工作" tabindex="-1"><a class="header-anchor" href="#_1-准备工作"><span>1. 准备工作</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 在控制节点安装 Ansible</span></span>
<span class="line">yum <span class="token function">install</span> <span class="token parameter variable">-y</span> ansible</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 配置 Inventory</span></span>
<span class="line"><span class="token function">cat</span> <span class="token operator">&gt;</span> /etc/ansible/hosts <span class="token operator">&lt;&lt;</span><span class="token string">EOF</span>
<span class="line">[lb]</span>
<span class="line">192.168.50.66</span>
<span class="line">192.168.50.110</span>
<span class="line"></span>
<span class="line">[web]</span>
<span class="line">192.168.50.111</span>
<span class="line">192.168.50.112</span>
<span class="line"></span>
<span class="line">[db]</span>
<span class="line">192.168.50.113</span>
<span class="line">EOF</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-编写-playbook" tabindex="-1"><a class="header-anchor" href="#_2-编写-playbook"><span>2. 编写 Playbook</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token punctuation">---</span></span>
<span class="line"><span class="token comment"># 部署负载均衡</span></span>
<span class="line"><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> lb</span>
<span class="line">  <span class="token key atrule">tasks</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install keepalived and nginx</span>
<span class="line">      <span class="token key atrule">yum</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">name</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token punctuation">-</span> keepalived</span>
<span class="line">          <span class="token punctuation">-</span> nginx</span>
<span class="line">        <span class="token key atrule">state</span><span class="token punctuation">:</span> present</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 部署 Web 服务</span></span>
<span class="line"><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> web</span>
<span class="line">  <span class="token key atrule">tasks</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install web components</span>
<span class="line">      <span class="token key atrule">yum</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">name</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token punctuation">-</span> httpd</span>
<span class="line">          <span class="token punctuation">-</span> php</span>
<span class="line">          <span class="token punctuation">-</span> php<span class="token punctuation">-</span>mysql</span>
<span class="line">        <span class="token key atrule">state</span><span class="token punctuation">:</span> present</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 部署数据库</span></span>
<span class="line"><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> db</span>
<span class="line">  <span class="token key atrule">tasks</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install MariaDB</span>
<span class="line">      <span class="token key atrule">yum</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">name</span><span class="token punctuation">:</span> mariadb<span class="token punctuation">-</span>server</span>
<span class="line">        <span class="token key atrule">state</span><span class="token punctuation">:</span> present</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="最佳实践" tabindex="-1"><a class="header-anchor" href="#最佳实践"><span>最佳实践</span></a></h2><ol><li><p><strong>部署建议</strong></p><ul><li>先测试后部署</li><li>分步骤验证</li><li>做好备份</li></ul></li><li><p><strong>维护建议</strong></p><ul><li>监控服务状态</li><li>定期更新</li><li>记录变更</li></ul></li></ol><blockquote><p><strong>注意：</strong></p><ul><li>确保网络连通性</li><li>检查防火墙配置</li><li>验证服务依赖关系</li></ul></blockquote><hr><blockquote><p><strong>参考资料：</strong></p><ul><li><a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_best_practices.html" target="_blank" rel="noopener noreferrer">Ansible 最佳实践</a></li><li><a href="http://www.keepalived.org/doc/" target="_blank" rel="noopener noreferrer">Keepalived 配置指南</a></li></ul></blockquote>`,17))])}const A=t(r,[["render",f],["__file","ansibleDeploy.html.vue"]]),D=JSON.parse('{"path":"/flinux/Ansible/AnsibleDeploy/ansibleDeploy.html","title":"Ansible 实战","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"项目目标","slug":"项目目标","link":"#项目目标","children":[]},{"level":2,"title":"环境规划","slug":"环境规划","link":"#环境规划","children":[{"level":3,"title":"服务器角色","slug":"服务器角色","link":"#服务器角色","children":[]}]},{"level":2,"title":"部署步骤","slug":"部署步骤","link":"#部署步骤","children":[{"level":3,"title":"1. 准备工作","slug":"_1-准备工作","link":"#_1-准备工作","children":[]},{"level":3,"title":"2. 编写 Playbook","slug":"_2-编写-playbook","link":"#_2-编写-playbook","children":[]}]},{"level":2,"title":"最佳实践","slug":"最佳实践","link":"#最佳实践","children":[]}],"git":{"updatedTime":1701020615000,"contributors":[{"name":"Linkefou","username":"Linkefou","email":"wlh724567296@163.com","commits":1}]},"filePathRelative":"flinux/Ansible/AnsibleDeploy/ansibleDeploy.md"}');export{A as comp,D as data};
