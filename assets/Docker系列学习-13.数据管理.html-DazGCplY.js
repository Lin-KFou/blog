import{_ as p,c as t,a as n,d as e,e as l,f as r,r as o,o as c,b as i}from"./app-BCC5ysrj.js";const d={},u={class:"vuepress-toc"},v={class:"vuepress-toc-item"},m={class:"vuepress-toc-item"},b={class:"vuepress-toc-item"},k={class:"vuepress-toc-item"},h={class:"vuepress-toc-item"},g={class:"vuepress-toc-item"},f={class:"vuepress-toc-item"},_={class:"vuepress-toc-item"},w={class:"vuepress-toc-item"},x={class:"vuepress-toc-item"};function y(D,s){const a=o("router-link");return c(),t("div",null,[s[10]||(s[10]=n("h1",{id:"_13-数据管理",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_13-数据管理"},[n("span",null,"13. 数据管理")])],-1)),n("nav",u,[n("ul",null,[n("li",v,[e(a,{to:"#简介"},{default:l(()=>s[0]||(s[0]=[i("简介")])),_:1})]),n("li",m,[e(a,{to:"#数据卷"},{default:l(()=>s[1]||(s[1]=[i("数据卷")])),_:1}),n("ul",null,[n("li",b,[e(a,{to:"#创建数据卷"},{default:l(()=>s[2]||(s[2]=[i("创建数据卷")])),_:1})]),n("li",k,[e(a,{to:"#启动一个挂载数据卷的容器"},{default:l(()=>s[3]||(s[3]=[i("启动一个挂载数据卷的容器")])),_:1})]),n("li",h,[e(a,{to:"#查看挂载信息"},{default:l(()=>s[4]||(s[4]=[i("查看挂载信息")])),_:1})]),n("li",g,[e(a,{to:"#删除数据卷"},{default:l(()=>s[5]||(s[5]=[i("删除数据卷")])),_:1})])])]),n("li",f,[e(a,{to:"#挂载主机目录"},{default:l(()=>s[6]||(s[6]=[i("挂载主机目录")])),_:1}),n("ul",null,[n("li",_,[e(a,{to:"#基本用法"},{default:l(()=>s[7]||(s[7]=[i("基本用法")])),_:1})]),n("li",w,[e(a,{to:"#使用-v-参数-传统方式"},{default:l(()=>s[8]||(s[8]=[i("使用 -v 参数（传统方式）")])),_:1})])])]),n("li",x,[e(a,{to:"#最佳实践"},{default:l(()=>s[9]||(s[9]=[i("最佳实践")])),_:1})])])]),s[11]||(s[11]=r(`<hr><h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介"><span>简介</span></a></h2><p>Docker 提供了多种方式来保证容器中的数据持久化，主要包括：</p><ul><li><strong>数据卷 (Volumes)</strong>: Docker 管理的持久化数据</li><li><strong>挂载主机目录 (Bind Mounts)</strong>: 将主机目录直接挂载到容器</li><li><strong>tmpfs 挂载</strong>: 将数据存储在内存中</li></ul><h2 id="数据卷" tabindex="-1"><a class="header-anchor" href="#数据卷"><span>数据卷</span></a></h2><p>数据卷是 Docker 引擎管理的持久化存储，具有以下特点：</p><ul><li>支持多容器共享和重用</li><li>数据修改实时生效</li><li>数据更新不影响镜像</li><li>数据持久化存储，独立于容器生命周期</li><li>支持多种存储后端驱动</li></ul><blockquote><p><strong>注意：</strong> 挂载数据卷会隐藏容器中对应目录的文件，类似 Linux 的 mount 机制</p></blockquote><h3 id="创建数据卷" tabindex="-1"><a class="header-anchor" href="#创建数据卷"><span>创建数据卷</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 创建数据卷</span></span>
<span class="line"><span class="token function">docker</span> volume create my-vol</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看所有数据卷</span></span>
<span class="line"><span class="token function">docker</span> volume <span class="token function">ls</span> </span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看数据卷详细信息</span></span>
<span class="line"><span class="token function">docker</span> volume inspect my-vol </span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="启动一个挂载数据卷的容器" tabindex="-1"><a class="header-anchor" href="#启动一个挂载数据卷的容器"><span>启动一个挂载数据卷的容器</span></a></h3><p>Docker 提供两种方式挂载数据卷：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 使用 --mount 参数（推荐）</span></span>
<span class="line"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-P</span> <span class="token parameter variable">--name</span> web <span class="token punctuation">\\</span></span>
<span class="line">    <span class="token parameter variable">--mount</span> <span class="token assign-left variable">source</span><span class="token operator">=</span>my-vol,target<span class="token operator">=</span>/webapp <span class="token punctuation">\\</span></span>
<span class="line">    training/webapp <span class="token punctuation">\\</span></span>
<span class="line">    python app.py</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 使用 -v 参数（传统方式）</span></span>
<span class="line"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-P</span> <span class="token parameter variable">--name</span> web <span class="token punctuation">\\</span></span>
<span class="line">    <span class="token parameter variable">-v</span> my-vol:/webapp <span class="token punctuation">\\</span></span>
<span class="line">    training/webapp <span class="token punctuation">\\</span></span>
<span class="line">    python app.py</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>参数说明：</strong></p><ul><li><code>source</code>: 数据卷名称或主机路径</li><li><code>target</code>: 容器内挂载路径</li><li><code>readonly</code>: 可选，设置只读权限</li></ul><h3 id="查看挂载信息" tabindex="-1"><a class="header-anchor" href="#查看挂载信息"><span>查看挂载信息</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 查看容器挂载信息</span></span>
<span class="line"><span class="token function">docker</span> inspect web <span class="token parameter variable">--format</span> <span class="token string">&#39;{{ .Mounts }}&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看详细配置</span></span>
<span class="line"><span class="token function">docker</span> inspect web</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="删除数据卷" tabindex="-1"><a class="header-anchor" href="#删除数据卷"><span>删除数据卷</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 删除指定数据卷</span></span>
<span class="line"><span class="token function">docker</span> volume <span class="token function">rm</span> my-vol</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 清理无主数据卷</span></span>
<span class="line"><span class="token function">docker</span> volume prune</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>注意：</strong> 如果要在删除容器时同时删除数据卷，请使用 <code>docker rm -v</code> 命令</p></blockquote><h2 id="挂载主机目录" tabindex="-1"><a class="header-anchor" href="#挂载主机目录"><span>挂载主机目录</span></a></h2><h3 id="基本用法" tabindex="-1"><a class="header-anchor" href="#基本用法"><span>基本用法</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 挂载主机目录</span></span>
<span class="line"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-P</span> <span class="token punctuation">\\</span></span>
<span class="line">    <span class="token parameter variable">--name</span> web <span class="token punctuation">\\</span></span>
<span class="line">    <span class="token parameter variable">--mount</span> <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,source<span class="token operator">=</span>/src/webapp,target<span class="token operator">=</span>/opt/webapp <span class="token punctuation">\\</span></span>
<span class="line">    training/webapp <span class="token punctuation">\\</span></span>
<span class="line">    python app.py</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 挂载为只读</span></span>
<span class="line"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-P</span> <span class="token punctuation">\\</span></span>
<span class="line">    <span class="token parameter variable">--name</span> web <span class="token punctuation">\\</span></span>
<span class="line">    <span class="token parameter variable">--mount</span> <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,source<span class="token operator">=</span>/src/webapp,target<span class="token operator">=</span>/opt/webapp,readonly <span class="token punctuation">\\</span></span>
<span class="line">    training/webapp <span class="token punctuation">\\</span></span>
<span class="line">    python app.py</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="使用-v-参数-传统方式" tabindex="-1"><a class="header-anchor" href="#使用-v-参数-传统方式"><span>使用 -v 参数（传统方式）</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-P</span> <span class="token punctuation">\\</span></span>
<span class="line">    <span class="token parameter variable">--name</span> web <span class="token punctuation">\\</span></span>
<span class="line">    <span class="token parameter variable">-v</span> /src/webapp:/opt/webapp <span class="token punctuation">\\</span></span>
<span class="line">    training/webapp <span class="token punctuation">\\</span></span>
<span class="line">    python app.py</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="最佳实践" tabindex="-1"><a class="header-anchor" href="#最佳实践"><span>最佳实践</span></a></h2><ol><li><p>数据卷使用建议</p><ul><li>优先使用数据卷而不是 bind mount</li><li>使用有意义的卷名</li><li>定期备份重要数据</li></ul></li><li><p>安全建议</p><ul><li>谨慎使用 bind mount</li><li>限制容器对主机目录的访问权限</li><li>避免挂载敏感目录</li></ul></li><li><p>性能优化</p><ul><li>避免挂载大量小文件</li><li>合理使用 tmpfs 挂载</li><li>选择合适的存储驱动</li></ul></li></ol><blockquote><p><strong>参考资料：</strong></p><ul><li><a href="https://docs.docker.com/storage/volumes/" target="_blank" rel="noopener noreferrer">Docker 官方文档 - Volumes</a></li><li><a href="https://docs.docker.com/storage/bind-mounts/" target="_blank" rel="noopener noreferrer">Docker 官方文档 - Bind mounts</a></li></ul></blockquote>`,28))])}const B=p(d,[["render",y],["__file","Docker系列学习-13.数据管理.html.vue"]]),A=JSON.parse('{"path":"/flinux/Kubernetes/Docker%E7%B3%BB%E5%88%97%E5%AD%A6%E4%B9%A0/Docker%E7%B3%BB%E5%88%97%E5%AD%A6%E4%B9%A0-13.%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86.html","title":"13. 数据管理","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"简介","slug":"简介","link":"#简介","children":[]},{"level":2,"title":"数据卷","slug":"数据卷","link":"#数据卷","children":[{"level":3,"title":"创建数据卷","slug":"创建数据卷","link":"#创建数据卷","children":[]},{"level":3,"title":"启动一个挂载数据卷的容器","slug":"启动一个挂载数据卷的容器","link":"#启动一个挂载数据卷的容器","children":[]},{"level":3,"title":"查看挂载信息","slug":"查看挂载信息","link":"#查看挂载信息","children":[]},{"level":3,"title":"删除数据卷","slug":"删除数据卷","link":"#删除数据卷","children":[]}]},{"level":2,"title":"挂载主机目录","slug":"挂载主机目录","link":"#挂载主机目录","children":[{"level":3,"title":"基本用法","slug":"基本用法","link":"#基本用法","children":[]},{"level":3,"title":"使用 -v 参数（传统方式）","slug":"使用-v-参数-传统方式","link":"#使用-v-参数-传统方式","children":[]}]},{"level":2,"title":"最佳实践","slug":"最佳实践","link":"#最佳实践","children":[]}],"git":{"updatedTime":1709276200000,"contributors":[{"name":"Linkefou","username":"Linkefou","email":"wlh724567296@163.com","commits":1},{"name":"wanglinhao","username":"wanglinhao","email":"wanglinhao@wegooooo.com","commits":2}]},"filePathRelative":"flinux/Kubernetes/Docker系列学习/Docker系列学习-13.数据管理.md"}');export{B as comp,A as data};
