import{_ as t,c as p,a,d as n,e as l,f as r,r as o,o as d,b as i}from"./app-BCC5ysrj.js";const c={},m={class:"vuepress-toc"},b={class:"vuepress-toc-item"},v={class:"vuepress-toc-item"},u={class:"vuepress-toc-item"},h={class:"vuepress-toc-item"},k={class:"vuepress-toc-item"},g={class:"vuepress-toc-item"},f={class:"vuepress-toc-item"},P={class:"vuepress-toc-item"},T={class:"vuepress-toc-item"},x={class:"vuepress-toc-item"},I={class:"vuepress-toc-item"};function _(A,s){const e=o("router-link");return d(),p("div",null,[s[11]||(s[11]=a("h1",{id:"iptable-防火墙",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#iptable-防火墙"},[a("span",null,"Iptable: 防火墙")])],-1)),a("nav",m,[a("ul",null,[a("li",b,[n(e,{to:"#什么是防火墙"},{default:l(()=>s[0]||(s[0]=[i("什么是防火墙")])),_:1}),a("ul",null,[a("li",v,[n(e,{to:"#防火墙分类"},{default:l(()=>s[1]||(s[1]=[i("防火墙分类")])),_:1})]),a("li",u,[n(e,{to:"#iptables的工作原理"},{default:l(()=>s[2]||(s[2]=[i("iptables的工作原理")])),_:1})]),a("li",h,[n(e,{to:"#netfilter-钩子点"},{default:l(()=>s[3]||(s[3]=[i("netfilter 钩子点")])),_:1})]),a("li",k,[n(e,{to:"#表和链"},{default:l(()=>s[4]||(s[4]=[i("表和链")])),_:1})]),a("li",g,[n(e,{to:"#防火墙策略"},{default:l(()=>s[5]||(s[5]=[i("防火墙策略")])),_:1})])])]),a("li",f,[n(e,{to:"#常用命令示例"},{default:l(()=>s[6]||(s[6]=[i("常用命令示例")])),_:1}),a("ul",null,[a("li",P,[n(e,{to:"#基本防护配置"},{default:l(()=>s[7]||(s[7]=[i("基本防护配置")])),_:1})]),a("li",T,[n(e,{to:"#服务访问控制"},{default:l(()=>s[8]||(s[8]=[i("服务访问控制")])),_:1})]),a("li",x,[n(e,{to:"#防止-ddos-攻击"},{default:l(()=>s[9]||(s[9]=[i("防止 DDoS 攻击")])),_:1})]),a("li",I,[n(e,{to:"#保存和恢复规则"},{default:l(()=>s[10]||(s[10]=[i("保存和恢复规则")])),_:1})])])])])]),s[12]||(s[12]=r(`<hr><h2 id="什么是防火墙" tabindex="-1"><a class="header-anchor" href="#什么是防火墙"><span>什么是防火墙</span></a></h2><p>防火墙是一种网络安全设备，用于控制和监控网络流量。主要分为：</p><ul><li><strong>硬件防火墙</strong>: 专用硬件设备</li><li><strong>软件防火墙</strong>: 如 Linux 的 iptables</li></ul><h3 id="防火墙分类" tabindex="-1"><a class="header-anchor" href="#防火墙分类"><span>防火墙分类</span></a></h3><ol><li><p><strong>网络层防火墙 (L3/L4)</strong></p><ul><li>工作在 OSI 第 3/4 层</li><li>主要检查源/目标地址和端口</li><li>处理速度快，适合大流量环境</li></ul></li><li><p><strong>应用层防火墙 (L7)</strong></p><ul><li>工作在 OSI 第 7 层</li><li>可以理解应用层协议</li><li>提供更细粒度的控制</li><li>处理速度相对较慢</li></ul></li></ol><h3 id="iptables的工作原理" tabindex="-1"><a class="header-anchor" href="#iptables的工作原理"><span>iptables的工作原理</span></a></h3><p>iptables 是 Linux 系统中的包过滤防火墙，具有以下特点：</p><ul><li>基于 netfilter 框架</li><li>支持状态检测</li><li>可扩展的规则系统</li><li>支持 NAT 和数据包修改</li></ul><h3 id="netfilter-钩子点" tabindex="-1"><a class="header-anchor" href="#netfilter-钩子点"><span>netfilter 钩子点</span></a></h3><p>netfilter 在内核中提供了 5 个钩子点：</p><ol><li><strong>PREROUTING</strong>: 数据包进入路由表之前</li><li><strong>INPUT</strong>: 数据包流入本地进程</li><li><strong>FORWARD</strong>: 数据包需要转发时</li><li><strong>OUTPUT</strong>: 本地进程发出的数据包</li><li><strong>POSTROUTING</strong>: 数据包离开路由表之后</li></ol><h3 id="表和链" tabindex="-1"><a class="header-anchor" href="#表和链"><span>表和链</span></a></h3><p>iptables 使用&quot;表&quot;来组织规则，每个表包含多个&quot;链&quot;：</p><h4 id="表的类型" tabindex="-1"><a class="header-anchor" href="#表的类型"><span>表的类型</span></a></h4><ol><li><strong>filter 表</strong>: 默认表，负责过滤</li><li><strong>nat 表</strong>: 网络地址转换</li><li><strong>mangle 表</strong>: 数据包修改</li><li><strong>raw 表</strong>: 连接跟踪豁免</li></ol><h4 id="规则匹配顺序" tabindex="-1"><a class="header-anchor" href="#规则匹配顺序"><span>规则匹配顺序</span></a></h4><ol><li>表的处理顺序：raw -&gt; mangle -&gt; nat -&gt; filter</li><li>链内规则从上到下依次匹配</li><li>找到匹配规则后执行动作，除非指定继续</li></ol><h3 id="防火墙策略" tabindex="-1"><a class="header-anchor" href="#防火墙策略"><span>防火墙策略</span></a></h3><p>iptables 支持两种基本策略：</p><ul><li><strong>DROP</strong>: 默认拒绝（白名单模式）</li><li><strong>ACCEPT</strong>: 默认允许（黑名单模式）</li></ul><h2 id="常用命令示例" tabindex="-1"><a class="header-anchor" href="#常用命令示例"><span>常用命令示例</span></a></h2><h3 id="基本防护配置" tabindex="-1"><a class="header-anchor" href="#基本防护配置"><span>基本防护配置</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 清空现有规则</span></span>
<span class="line">iptables <span class="token parameter variable">-F</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 设置默认策略</span></span>
<span class="line">iptables <span class="token parameter variable">-P</span> INPUT DROP</span>
<span class="line">iptables <span class="token parameter variable">-P</span> FORWARD DROP</span>
<span class="line">iptables <span class="token parameter variable">-P</span> OUTPUT ACCEPT</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 允许已建立的连接</span></span>
<span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> ESTABLISHED,RELATED <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 允许本地回环</span></span>
<span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-i</span> lo <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="服务访问控制" tabindex="-1"><a class="header-anchor" href="#服务访问控制"><span>服务访问控制</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 允许 SSH 访问</span></span>
<span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">22</span> <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 允许 Web 服务</span></span>
<span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">80</span> <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">443</span> <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="防止-ddos-攻击" tabindex="-1"><a class="header-anchor" href="#防止-ddos-攻击"><span>防止 DDoS 攻击</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 限制单 IP 并发连接数</span></span>
<span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--syn</span> <span class="token parameter variable">-m</span> connlimit --connlimit-above <span class="token number">15</span> <span class="token parameter variable">-j</span> DROP</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 限制连接速率</span></span>
<span class="line">iptables <span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">80</span> <span class="token parameter variable">-m</span> limit <span class="token parameter variable">--limit</span> <span class="token number">25</span>/minute --limit-burst <span class="token number">100</span> <span class="token parameter variable">-j</span> ACCEPT</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="保存和恢复规则" tabindex="-1"><a class="header-anchor" href="#保存和恢复规则"><span>保存和恢复规则</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 保存规则</span></span>
<span class="line">iptables-save <span class="token operator">&gt;</span> /etc/iptables/rules.v4</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 恢复规则</span></span>
<span class="line">iptables-restore <span class="token operator">&lt;</span> /etc/iptables/rules.v4</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>最佳实践：</strong></p><ul><li>始终备份当前规则</li><li>先测试后应用</li><li>保留远程管理访问</li><li>定期审计规则</li></ul></blockquote>`,31))])}const N=t(c,[["render",_],["__file","IptableInfo.html.vue"]]),U=JSON.parse('{"path":"/flinux/Iptable/IptableInfo.html","title":"Iptable: 防火墙","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"什么是防火墙","slug":"什么是防火墙","link":"#什么是防火墙","children":[{"level":3,"title":"防火墙分类","slug":"防火墙分类","link":"#防火墙分类","children":[]},{"level":3,"title":"iptables的工作原理","slug":"iptables的工作原理","link":"#iptables的工作原理","children":[]},{"level":3,"title":"netfilter 钩子点","slug":"netfilter-钩子点","link":"#netfilter-钩子点","children":[]},{"level":3,"title":"表和链","slug":"表和链","link":"#表和链","children":[]},{"level":3,"title":"防火墙策略","slug":"防火墙策略","link":"#防火墙策略","children":[]}]},{"level":2,"title":"常用命令示例","slug":"常用命令示例","link":"#常用命令示例","children":[{"level":3,"title":"基本防护配置","slug":"基本防护配置","link":"#基本防护配置","children":[]},{"level":3,"title":"服务访问控制","slug":"服务访问控制","link":"#服务访问控制","children":[]},{"level":3,"title":"防止 DDoS 攻击","slug":"防止-ddos-攻击","link":"#防止-ddos-攻击","children":[]},{"level":3,"title":"保存和恢复规则","slug":"保存和恢复规则","link":"#保存和恢复规则","children":[]}]}],"git":{"updatedTime":1701020615000,"contributors":[{"name":"Linkefou","username":"Linkefou","email":"wlh724567296@163.com","commits":1}]},"filePathRelative":"flinux/Iptable/IptableInfo.md"}');export{N as comp,U as data};
