import{_ as i,c as p,a as s,d as t,e,f as o,r as c,o as u,b as l}from"./app-BCC5ysrj.js";const d={},r={class:"vuepress-toc"},k={class:"vuepress-toc-item"},v={class:"vuepress-toc-item"},m={class:"vuepress-toc-item"},f={class:"vuepress-toc-item"},h={class:"vuepress-toc-item"},b={class:"vuepress-toc-item"},g={class:"vuepress-toc-item"},x={class:"vuepress-toc-item"},_={class:"vuepress-toc-item"};function y(q,n){const a=c("router-link");return u(),p("div",null,[n[9]||(n[9]=s("h1",{id:"python-业务服务监控",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#python-业务服务监控"},[s("span",null,"Python: 业务服务监控")])],-1)),s("nav",r,[s("ul",null,[s("li",k,[t(a,{to:"#简介"},{default:e(()=>n[0]||(n[0]=[l("简介")])),_:1})]),s("li",v,[t(a,{to:"#文件差异监控"},{default:e(()=>n[1]||(n[1]=[l("文件差异监控")])),_:1}),s("ul",null,[s("li",m,[t(a,{to:"#difflib-模块介绍"},{default:e(()=>n[2]||(n[2]=[l("difflib 模块介绍")])),_:1})]),s("li",f,[t(a,{to:"#差异符号说明"},{default:e(()=>n[3]||(n[3]=[l("差异符号说明")])),_:1})]),s("li",h,[t(a,{to:"#基本用法"},{default:e(()=>n[4]||(n[4]=[l("基本用法")])),_:1})]),s("li",b,[t(a,{to:"#html-报告生成"},{default:e(()=>n[5]||(n[5]=[l("HTML 报告生成")])),_:1})])])]),s("li",g,[t(a,{to:"#配置文件监控"},{default:e(()=>n[6]||(n[6]=[l("配置文件监控")])),_:1}),s("ul",null,[s("li",x,[t(a,{to:"#nginx-配置监控示例"},{default:e(()=>n[7]||(n[7]=[l("Nginx 配置监控示例")])),_:1})])])]),s("li",_,[t(a,{to:"#最佳实践"},{default:e(()=>n[8]||(n[8]=[l("最佳实践")])),_:1})])])]),n[10]||(n[10]=o(`<hr><h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介"><span>简介</span></a></h2><p>业务服务监控是运维体系中的关键组件，用于：</p><ul><li>保证服务质量</li><li>及时发现问题</li><li>自动化处理异常</li></ul><h2 id="文件差异监控" tabindex="-1"><a class="header-anchor" href="#文件差异监控"><span>文件差异监控</span></a></h2><h3 id="difflib-模块介绍" tabindex="-1"><a class="header-anchor" href="#difflib-模块介绍"><span>difflib 模块介绍</span></a></h3><p>Python 内置的 difflib 模块提供了强大的差异对比功能：</p><ul><li>支持文本差异比较</li><li>可生成 HTML 格式报告</li><li>类似 Linux diff 命令</li></ul><h3 id="差异符号说明" tabindex="-1"><a class="header-anchor" href="#差异符号说明"><span>差异符号说明</span></a></h3><table><thead><tr><th>符号</th><th>含义</th></tr></thead><tbody><tr><td><code>-</code></td><td>第一个序列独有的行</td></tr><tr><td><code>+</code></td><td>第二个序列独有的行</td></tr><tr><td>\`\`</td><td>两个序列共有的行</td></tr><tr><td><code>?</code></td><td>行内差异标记</td></tr><tr><td><code>^</code></td><td>差异字符位置标记</td></tr></tbody></table><h3 id="基本用法" tabindex="-1"><a class="header-anchor" href="#基本用法"><span>基本用法</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> difflib</span>
<span class="line"></span>
<span class="line">text1 <span class="token operator">=</span> <span class="token triple-quoted-string string">&#39;&#39;&#39;</span>
<span class="line">This module provides classes and functions for comparing sequences.</span>
<span class="line">including HTML and context and unified diffs.</span>
<span class="line">difflib document v7.4</span>
<span class="line">add string</span>
<span class="line">&#39;&#39;&#39;</span></span>
<span class="line">text1_lines <span class="token operator">=</span> text1<span class="token punctuation">.</span>splitlines<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">text2 <span class="token operator">=</span> <span class="token triple-quoted-string string">&#39;&#39;&#39;</span>
<span class="line">This module provides classes and functions for Comparing sequences.</span>
<span class="line">including HTML and context and unified diffs.</span>
<span class="line">difflib document v7.5</span>
<span class="line">&#39;&#39;&#39;</span></span>
<span class="line">text2_lines <span class="token operator">=</span> text2<span class="token punctuation">.</span>splitlines<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 创建差异对比器</span></span>
<span class="line">d <span class="token operator">=</span> difflib<span class="token punctuation">.</span>Differ<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">diff <span class="token operator">=</span> d<span class="token punctuation">.</span>compare<span class="token punctuation">(</span>text1_lines<span class="token punctuation">,</span> text2_lines<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;\\n&#39;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>diff<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="html-报告生成" tabindex="-1"><a class="header-anchor" href="#html-报告生成"><span>HTML 报告生成</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">def</span> <span class="token function">generate_diff_html</span><span class="token punctuation">(</span>file1<span class="token punctuation">,</span> file2<span class="token punctuation">,</span> out_file<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;生成差异对比的 HTML 报告&quot;&quot;&quot;</span></span>
<span class="line">    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file1<span class="token punctuation">,</span> <span class="token string">&#39;r&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f1<span class="token punctuation">,</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file2<span class="token punctuation">,</span> <span class="token string">&#39;r&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f2<span class="token punctuation">:</span></span>
<span class="line">        text1 <span class="token operator">=</span> f1<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        text2 <span class="token operator">=</span> f2<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    d <span class="token operator">=</span> difflib<span class="token punctuation">.</span>HtmlDiff<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    html <span class="token operator">=</span> d<span class="token punctuation">.</span>make_file<span class="token punctuation">(</span>text1<span class="token punctuation">,</span> text2<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>out_file<span class="token punctuation">,</span> <span class="token string">&#39;w&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>html<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="配置文件监控" tabindex="-1"><a class="header-anchor" href="#配置文件监控"><span>配置文件监控</span></a></h2><h3 id="nginx-配置监控示例" tabindex="-1"><a class="header-anchor" href="#nginx-配置监控示例"><span>Nginx 配置监控示例</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">def</span> <span class="token function">monitor_nginx_config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;监控 Nginx 配置文件变化&quot;&quot;&quot;</span></span>
<span class="line">    config_file <span class="token operator">=</span> <span class="token string">&#39;/etc/nginx/nginx.conf&#39;</span></span>
<span class="line">    backup_file <span class="token operator">=</span> <span class="token string">&#39;/tmp/nginx.conf.bak&#39;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>backup_file<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        generate_diff_html<span class="token punctuation">(</span>backup_file<span class="token punctuation">,</span> config_file<span class="token punctuation">,</span> <span class="token string">&#39;nginx_diff.html&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># 更新备份</span></span>
<span class="line">    shutil<span class="token punctuation">.</span>copy2<span class="token punctuation">(</span>config_file<span class="token punctuation">,</span> backup_file<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="最佳实践" tabindex="-1"><a class="header-anchor" href="#最佳实践"><span>最佳实践</span></a></h2><ol><li><p><strong>监控策略</strong></p><ul><li>定期检查关键文件</li><li>设置合理的检查间隔</li><li>保存历史版本</li></ul></li><li><p><strong>告警机制</strong></p><ul><li>设置告警阈值</li><li>多渠道通知</li><li>记录变更日志</li></ul></li></ol><blockquote><p><strong>注意：</strong></p><ul><li>注意文件编码</li><li>处理大文件性能</li><li>保护敏感信息</li></ul></blockquote>`,20))])}const T=i(d,[["render",y],["__file","Python-业务服务监控.html.vue"]]),L=JSON.parse('{"path":"/fpython/example/Python-%E4%B8%9A%E5%8A%A1%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%8E%A7.html","title":"Python: 业务服务监控","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"简介","slug":"简介","link":"#简介","children":[]},{"level":2,"title":"文件差异监控","slug":"文件差异监控","link":"#文件差异监控","children":[{"level":3,"title":"difflib 模块介绍","slug":"difflib-模块介绍","link":"#difflib-模块介绍","children":[]},{"level":3,"title":"差异符号说明","slug":"差异符号说明","link":"#差异符号说明","children":[]},{"level":3,"title":"基本用法","slug":"基本用法","link":"#基本用法","children":[]},{"level":3,"title":"HTML 报告生成","slug":"html-报告生成","link":"#html-报告生成","children":[]}]},{"level":2,"title":"配置文件监控","slug":"配置文件监控","link":"#配置文件监控","children":[{"level":3,"title":"Nginx 配置监控示例","slug":"nginx-配置监控示例","link":"#nginx-配置监控示例","children":[]}]},{"level":2,"title":"最佳实践","slug":"最佳实践","link":"#最佳实践","children":[]}],"git":{"updatedTime":1735029308000,"contributors":[{"name":"Linkefou","username":"Linkefou","email":"wlh724567296@163.com","commits":1},{"name":"wanglinhao","username":"wanglinhao","email":"wanglinhao@wegooooo.com","commits":4}]},"filePathRelative":"fpython/example/Python-业务服务监控.md"}');export{T as comp,L as data};
