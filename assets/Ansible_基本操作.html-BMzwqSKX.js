import{_ as t,c as p,a as n,d as e,e as l,f as o,r as c,o as r,b as i}from"./app-BCC5ysrj.js";const d={},u={class:"vuepress-toc"},v={class:"vuepress-toc-item"},m={class:"vuepress-toc-item"},b={class:"vuepress-toc-item"},h={class:"vuepress-toc-item"},k={class:"vuepress-toc-item"},g={class:"vuepress-toc-item"},_={class:"vuepress-toc-item"},f={class:"vuepress-toc-item"},y={class:"vuepress-toc-item"};function x(A,s){const a=c("router-link");return r(),p("div",null,[s[9]||(s[9]=n("h1",{id:"ansible-基本操作",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ansible-基本操作"},[n("span",null,"Ansible: 基本操作")])],-1)),n("nav",u,[n("ul",null,[n("li",v,[e(a,{to:"#inventory-配置"},{default:l(()=>s[0]||(s[0]=[i("Inventory 配置")])),_:1}),n("ul",null,[n("li",m,[e(a,{to:"#创建-inventory-文件"},{default:l(()=>s[1]||(s[1]=[i("创建 Inventory 文件")])),_:1})]),n("li",b,[e(a,{to:"#基本命令"},{default:l(()=>s[2]||(s[2]=[i("基本命令")])),_:1})])])]),n("li",h,[e(a,{to:"#ssh-配置"},{default:l(()=>s[3]||(s[3]=[i("SSH 配置")])),_:1}),n("ul",null,[n("li",k,[e(a,{to:"#禁用-known-hosts-检查"},{default:l(()=>s[4]||(s[4]=[i("禁用 known_hosts 检查")])),_:1})])])]),n("li",g,[e(a,{to:"#主机组定义"},{default:l(()=>s[5]||(s[5]=[i("主机组定义")])),_:1}),n("ul",null,[n("li",_,[e(a,{to:"#主机变量"},{default:l(()=>s[6]||(s[6]=[i("主机变量")])),_:1})]),n("li",f,[e(a,{to:"#主机模式"},{default:l(()=>s[7]||(s[7]=[i("主机模式")])),_:1})])])]),n("li",y,[e(a,{to:"#最佳实践"},{default:l(()=>s[8]||(s[8]=[i("最佳实践")])),_:1})])])]),s[10]||(s[10]=o(`<hr><h2 id="inventory-配置" tabindex="-1"><a class="header-anchor" href="#inventory-配置"><span>Inventory 配置</span></a></h2><h3 id="创建-inventory-文件" tabindex="-1"><a class="header-anchor" href="#创建-inventory-文件"><span>创建 Inventory 文件</span></a></h3><p>Inventory 文件用于定义 Ansible 要管理的主机列表。默认路径为 <code>/etc/ansible/hosts</code>。</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 创建基本 inventory</span></span>
<span class="line"><span class="token function">cat</span> <span class="token operator">&gt;</span> /etc/ansible/hosts <span class="token operator">&lt;&lt;</span>EOL</span>
<span class="line"><span class="token number">192.168</span>.50.66</span>
<span class="line"><span class="token number">192.168</span>.50.110</span>
<span class="line"><span class="token number">192.168</span>.50.111</span>
<span class="line"><span class="token number">192.168</span>.50.112</span>
<span class="line">EOF</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="基本命令" tabindex="-1"><a class="header-anchor" href="#基本命令"><span>基本命令</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 测试连通性</span></span>
<span class="line">ansible all <span class="token parameter variable">-m</span> <span class="token function">ping</span> </span>
<span class="line"><span class="token comment"># 执行命令</span></span>
<span class="line">ansible all <span class="token parameter variable">-a</span> <span class="token string">&quot;/bin/echo hello&quot;</span></span>
<span class="line"><span class="token comment"># 单行显示结果</span></span>
<span class="line">ansible servers <span class="token parameter variable">-m</span> <span class="token function">ping</span> <span class="token parameter variable">-o</span></span>
<span class="line"><span class="token comment"># 执行 shell 命令</span></span>
<span class="line">ansible servers <span class="token parameter variable">-m</span> shell <span class="token parameter variable">-a</span> <span class="token string">&#39;uptime&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ssh-配置" tabindex="-1"><a class="header-anchor" href="#ssh-配置"><span>SSH 配置</span></a></h2><h3 id="禁用-known-hosts-检查" tabindex="-1"><a class="header-anchor" href="#禁用-known-hosts-检查"><span>禁用 known_hosts 检查</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 方法一：配置文件</span></span>
<span class="line"><span class="token function">cat</span> <span class="token operator">&gt;</span> ~/.ansible.cfg <span class="token operator">&lt;&lt;</span><span class="token string">EOF</span>
<span class="line">[defaults]</span>
<span class="line">host_key_checking = False</span>
<span class="line">EOF</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 方法二：环境变量</span></span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">ANSIBLE_HOST_KEY_CHECKING</span><span class="token operator">=</span>False</span>
<span class="line"><span class="token comment"># Inventory 文件格式</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="主机组定义" tabindex="-1"><a class="header-anchor" href="#主机组定义"><span>主机组定义</span></a></h2><div class="language-ini line-numbers-mode" data-highlighter="prismjs" data-ext="ini" data-title="ini"><pre><code><span class="line"><span class="token comment"># 基本格式</span></span>
<span class="line"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">nameserver</span><span class="token punctuation">]</span></span>   </span>
<span class="line">192.168.50.66</span>
<span class="line">192.168.50.110</span>
<span class="line"></span>
<span class="line"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">dbserver</span><span class="token punctuation">]</span></span></span>
<span class="line">192.168.50.111</span>
<span class="line">192.168.50.112</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="主机变量" tabindex="-1"><a class="header-anchor" href="#主机变量"><span>主机变量</span></a></h3><div class="language-ini line-numbers-mode" data-highlighter="prismjs" data-ext="ini" data-title="ini"><pre><code><span class="line"><span class="token comment"># 指定连接参数</span></span>
<span class="line"><span class="token key attr-name">jumper ansible_ssh_port</span><span class="token punctuation">=</span><span class="token value attr-value">5555 ansible_ssh_host=192.168.50.66</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 指定连接类型和用户</span></span>
<span class="line"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">targets</span><span class="token punctuation">]</span></span></span>
<span class="line"><span class="token key attr-name">localhost           ansible_connection</span><span class="token punctuation">=</span><span class="token value attr-value">local</span></span>
<span class="line"><span class="token key attr-name">other1.example.com  ansible_connection</span><span class="token punctuation">=</span><span class="token value attr-value">ssh  ansible_ssh_user=root</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="主机模式" tabindex="-1"><a class="header-anchor" href="#主机模式"><span>主机模式</span></a></h3><div class="language-ini line-numbers-mode" data-highlighter="prismjs" data-ext="ini" data-title="ini"><pre><code><span class="line"><span class="token comment"># 使用范围表达式</span></span>
<span class="line"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">webserver</span><span class="token punctuation">]</span></span></span>
<span class="line">www[01:50].example.com</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 使用字母范围</span></span>
<span class="line"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">dbserver</span><span class="token punctuation">]</span></span></span>
<span class="line">db-[a:f].example.com</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="最佳实践" tabindex="-1"><a class="header-anchor" href="#最佳实践"><span>最佳实践</span></a></h2><ol><li><p><strong>配置建议</strong></p><ul><li>使用组织良好的目录结构</li><li>合理使用主机组</li><li>善用变量文件</li></ul></li><li><p><strong>安全建议</strong></p><ul><li>使用密钥认证</li><li>限制主机访问</li><li>定期更新配置</li></ul></li></ol><blockquote><p><strong>注意：</strong></p><ul><li>注意文件权限设置</li><li>避免明文存储密码</li><li>及时更新 inventory</li></ul></blockquote><hr><blockquote><p><strong>参考资料：</strong></p><ul><li><a href="https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html" target="_blank" rel="noopener noreferrer">Ansible Inventory 指南</a></li><li><a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_best_practices.html" target="_blank" rel="noopener noreferrer">Ansible 最佳实践</a></li></ul></blockquote>`,21))])}const E=t(d,[["render",x],["__file","Ansible_基本操作.html.vue"]]),I=JSON.parse('{"path":"/flinux/Ansible/Ansible_%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C.html","title":"Ansible: 基本操作","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"Inventory 配置","slug":"inventory-配置","link":"#inventory-配置","children":[{"level":3,"title":"创建 Inventory 文件","slug":"创建-inventory-文件","link":"#创建-inventory-文件","children":[]},{"level":3,"title":"基本命令","slug":"基本命令","link":"#基本命令","children":[]}]},{"level":2,"title":"SSH 配置","slug":"ssh-配置","link":"#ssh-配置","children":[{"level":3,"title":"禁用 known_hosts 检查","slug":"禁用-known-hosts-检查","link":"#禁用-known-hosts-检查","children":[]}]},{"level":2,"title":"主机组定义","slug":"主机组定义","link":"#主机组定义","children":[{"level":3,"title":"主机变量","slug":"主机变量","link":"#主机变量","children":[]},{"level":3,"title":"主机模式","slug":"主机模式","link":"#主机模式","children":[]}]},{"level":2,"title":"最佳实践","slug":"最佳实践","link":"#最佳实践","children":[]}],"git":{},"filePathRelative":"flinux/Ansible/Ansible:基本操作.md"}');export{E as comp,I as data};
